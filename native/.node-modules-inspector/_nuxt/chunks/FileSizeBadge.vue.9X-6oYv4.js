import{e as M,j as l,aN as G,D as E,af as m,ax as $,$ as z,x as I,J,aO as q,aP as H,aQ as Q,aR as Y,W as X,aS as Z,aT as ee,aU as te,k as D,aV as ae,c as h,o as _,t as y,y as S,M as ne,h as V,a as O,b as R,n as B,K as A,d as se,g as re}from"../entry.BBXTE6X0.js";const De=M({name:"DisplayModuleType",props:{pkg:{type:[Object,String],required:!0},badge:{type:Boolean,default:!0},force:{type:Boolean,default:!1}},setup(a){const e=l(()=>G(a.pkg)),t=l(()=>{if(e.value==="cjs")return"CommonJS module. The legacy non-standard format.";if(e.value==="esm")return"Standard Ecmascript module format";if(e.value==="dual")return"Package that ships both ESM and CJS";if(e.value==="faux")return"Package that ships non-standard module format, that might work with some bundlers but not Node.js";if(e.value==="dts")return"Package that ships TypeScript types"});return()=>E.value.moduleTypeRender==="none"&&!a.force?null:E.value.moduleTypeRender==="circle"&&!a.force?m(z,{},{default:()=>m("div",{class:"flex",title:e.value.toUpperCase()},m("div",{class:["w-3 h-3 rounded-full border border-current!",$[e.value]]})),popper:()=>m("div",{class:"text-sm"},t.value)}):m(z,{},{default:()=>m("div",{class:["select-none",$[e.value],a.badge?"w-11 flex-none text-center px1 rounded text-sm":"bg-transparent! w-auto!"]},e.value.toUpperCase()),popper:()=>m("div",{class:"text-sm"},t.value)})}});function oe(a){const e=new Map;for(const t of a)e.has(t.name)||e.set(t.name,[]),e.get(t.name).push(t);return e}function f(a){const e=l(a),t=l(()=>new Map(e.value.map(n=>[n.spec,n]))),s=l(()=>oe(e.value)),p=l(()=>{const n=new Set;for(const o of e.value)for(const i of o.clusters)n.add(i);return n}),u=n=>typeof n=="string"?t.value.get(n):t.value.has(n.spec)?n:void 0,k=n=>t.value.has(typeof n=="string"?n:n.spec),r=n=>Array.from(function*(){for(const o of n){const i=u(o);i&&(yield i)}}()),c={dependencies:new Map,dependents:new Map,flatDependencies:new Map,flatDependents:new Map},d=new Map;I(e,()=>{c.dependencies.clear(),c.dependents.clear(),c.flatDependencies.clear(),c.flatDependents.clear(),d.clear()});function g(n){return o=>{const i=c[n].get(o.spec);if(i)return i;const P=r(o[n]);return c[n].set(o.spec,P),P}}const b=g("flatDependents"),x=g("flatDependencies"),j=g("dependencies"),F=g("dependents");function N(n){const o=d.get(n.spec);if(o)return o;const i=new Set(n.clusters);for(const P of b(n))for(const W of P.clusters)i.add(W);return d.set(n.spec,i),i}function K(n,o){return N(n).has(o==="dev"?H:o==="prod"?Q:Y)}return J({packages:e,map:t,versions:s,clusters:p,has:k,get:u,getList:r,dependencies:j,dependents:F,flatDependents:b,flatDependencies:x,flatClusters:N,isInDepCluster:K})}const v=f(()=>{var a;return Array.from(((a=X.value)==null?void 0:a.packages.values())||[])}),ce=f(()=>{var a;return Array.from(((a=te.value)==null?void 0:a.packages.values())||[])}),U=f(()=>{const a=new Set(v.packages.filter(ae));let e=!0;for(;e;){e=!1;for(const t of v.packages){if(a.has(t)||!t.dependents.size)continue;let s=!0;for(const p of t.dependents){const u=v.map.get(p);if(!u||!a.has(u)){s=!1;break}}s&&(a.add(t),e=!0)}}if(D.state.excludeWorkspace)for(const t of v.packages)t.workspace&&a.add(t);return Array.from(a)}),le=f(()=>v.packages.filter(a=>a.workspace)),w=f(()=>v.packages.filter(a=>!U.map.has(a.spec))),ie=f(()=>w.packages.filter(q.value)),ue=f(()=>{var e;if(!((e=D.state.compareA)!=null&&e.length))return[];const a=new Set(w.getList(D.state.compareA).flatMap(t=>[t,...w.flatDependencies(t)]));return Array.from(a)}),pe=f(()=>{var e;if(!((e=D.state.compareB)!=null&&e.length))return[];const a=new Set(w.getList(D.state.compareB).flatMap(t=>[t,...w.flatDependencies(t)]));return Array.from(a)}),T={main:v,excluded:U,workspace:le,avaliable:w,filtered:ie,compareA:ue,compareB:pe,reference:ce};function L(a){const e=T.main.get(a);return e&&(e.resolved.npmMeta||Z.value.get(e.spec))||null}function de(a){const e=T.main.get(a);return e&&[e.resolved.npmMetaLatest,ee.value.get(e.name)].filter(t=>!!t).sort((t,s)=>s.fetechedAt-t.fetechedAt)[0]||null}function Me(a){var t;const e=(t=L(a))==null?void 0:t.publishedAt;return e?new Date(e):null}function fe(a){const e=L(a),t=de(a);return!(e!=null&&e.deprecated)&&!(t!=null&&t.deprecated)?null:{type:e!=null&&e.deprecated&&(t!=null&&t.deprecated)?"package":e!=null&&e.deprecated&&!(t!=null&&t.deprecated)?"current":"future",current:e==null?void 0:e.deprecated,latest:t==null?void 0:t.deprecated,latestVersion:t==null?void 0:t.version}}const ge=l(()=>Array.from(T.avaliable.packages).reduce((a,e)=>{var t;return a+(((t=e.resolved.installSize)==null?void 0:t.bytes)||0)},0)),me={"font-mono":""},ve=M({__name:"PackageName",props:{name:{}},setup(a){return(e,t)=>(_(),h("span",me,y(e.name),1))}}),he={key:0,"font-mono":""},_e=M({__name:"Version",props:{version:{},prefix:{}},setup(a){return(e,t)=>{var s;return e.version?(_(),h("span",he,y(e.prefix||"")+y((s=e.version)!=null&&s.includes(":")?e.version:`${e.prefix?"":"v"}${e.version}`),1)):S("",!0)}}}),ke={key:0,"h-1em":"","w-1.5em":"",relative:"","of-visible":"","inline-block":""},xe=M({__name:"PackageSpec",props:{pkg:{}},setup(a){const e=a,t=l(()=>fe(e.pkg));return(s,p)=>{var c,d,g,b,x;const u=ve,k=_e,r=ne("tooltip");return _(),h("span",null,[s.pkg.workspace?(_(),h("span",ke,p[0]||(p[0]=[O("div",{title:"Workspace Package","i-catppuccin-folder-packages-open":"","icon-catppuccin":"",mr2:"",absolute:"","left-0":"","top-0":""},null,-1)]))):S("",!0),V(R(u,{name:e.pkg.name,pkg:e.pkg,class:B((c=t.value)!=null&&c.latest?((d=t.value)==null?void 0:d.type)==="future"?"text-orange line-through":"text-red line-through":void 0)},null,8,["name","pkg","class"]),[[r,(g=t.value)!=null&&g.latest?`Package is deprecated: ${t.value.latest}`:void 0]]),V(R(k,{op50:"",version:e.pkg.version,prefix:"@",class:B({"text-red line-through":(b=t.value)==null?void 0:b.current})},null,8,["version","class"]),[[r,(x=t.value)!=null&&x.current?`Current version is deprecated: ${t.value.current}`:void 0]])])}}}),Pe=l({get(){return A.selected?T.main.get(A.selected):void 0},set(a){A.selected=a==null?void 0:a.spec}});function ye(a,e=2){const t=["Bytes","KB","MB","GB","TB"],s=Math.floor(Math.log(a)/Math.log(1024));return s===0?["<1","K"]:[(+(a/1024**s).toFixed(e)).toLocaleString(),t[s]]}const we={"text-xs":"",op75:"","ml-0.4":""},be={key:0,"text-xs":"",ml1:"",op50:"",border:"l base",pl1:""},C=1024,Be=M({__name:"FileSizeBadge",props:{bytes:{},colorize:{type:Boolean,default:!0},digits:{default:2},precent:{type:Boolean,default:!0},icon:{}},setup(a){const e=a,t=C**2,s=[[80*C,"color-scale-neutral"],[500*C,"color-scale-low"],[1*t,"color-scale-medium"],[10*t,"color-scale-high"],[20*t,"color-scale-critical"]],p=l(()=>{if(!E.value.colorizePackageSize&&!e.colorize)return s[0];const r=e.bytes||0;for(const[c,d]of s)if(r<c)return d;return s[s.length-1][1]}),u=l(()=>(e.bytes||0)*100/ge.value),k=l(()=>ye(e.bytes||0,e.digits));return(r,c)=>r.bytes?(_(),h("div",{key:0,class:B([p.value,"px-0.4em py-0.2em font-mono line-height-none bg-gray:5 flex items-center"])},[r.icon?(_(),h("div",{key:0,class:B([r.icon,"mr-1"])},null,2)):S("",!0),se(" "+y(k.value[0]),1),O("span",we,y(k.value[1]),1),re(r.$slots,"after",{},()=>[r.precent&&u.value>.5?(_(),h("span",be,y(+u.value.toFixed(1))+"%",1)):S("",!0)])],2)):S("",!0)}});export{xe as _,De as a,Be as b,de as c,ve as d,_e as e,fe as f,Me as g,ye as h,T as p,Pe as s,ge as t};
